<div class="profile-banner" style="background-image: linear-gradient(-225deg, rgba(0,101,168,0.6) 0%, rgba(0,36,61,0.6) 50%), url(u);">

</div>
  <div class="container">
  <div class="profile-details">

    <div class="profile-pic col-xs-6">
      <%= cl_image_tag @friend.photo, height: 300, width: 400, crop: :fill %>
    </div>

      <div class="col-xs-6">

        <div class="profile-desc">
          <h2> <%= @friend.first_name + " " + @friend.last_name  %> </h2>
          <h3> <%= @friend.description %> </h3>
          <h3> <%= @friend.age %> years old </h3>
          <h3> <%= @friend.price %> â‚¬/h </h3>
          <h3> owner: <%= @friend.user.first_name %> <%= @friend.user.last_name %> </h3>

          <div>
              <% @friend.friend_availabilities.each do |av| %>
              <p>Available from <%= Date::DAYNAMES[av.start_daytime.wday] %> <%= av.start_daytime.to_date  %> to <%= Date::DAYNAMES[av.end_daytime.wday] %> <%= av.end_daytime.to_date %></p>
              <% end %>
          </div>

        </div>

      </div>

  </div>


<table class="table table-striped">
      <thead>
        <tr>
          <th>Product</th>
          <th>Rating : <%= @average_rating %> </th>
          <th>Review</th>
          <th colspan="3"></th>
        </tr>
      </thead>

      <tbody>
        <% @friend.sales.each do |sale| %>
          <% if !sale.rating.nil? %>
        <tr>
                <td><%= sale.buyer.first_name %> <%= sale.buyer.last_name %></td>
                <td><%= sale.rating.buyer_rating %></td>
                <td><%= sale.rating.buyer_review %></td>
        </tr>
        <% else %>
        <tr>
          <td>No Ratings for this product</td>
          <td></td>
          <td></td>
        </tr>
        <% end %>
        <% end %>
      </tbody>
    </table>


  <table class="table table-striped">
      <thead>
        <tr>
          <th>Owner</th>
          <th>Rating</th>
          <th>Review</th>
          <th colspan="3"></th>
        </tr>
      </thead>

      <tbody>
        <% @friend.sales.each do |sale| %>
          <% if !sale.rating.nil? %>
        <tr>
                <td><%= sale.buyer.first_name %> <%= sale.buyer.last_name %></td>
                <td><%= sale.rating.buyer_rating %></td>
                <td><%= sale.rating.buyer_review %></td>
        </tr>
        <% else %>
        <tr>
          <td>No Ratings for this owner</td>
          <td></td>
          <td></td>
        </tr>
        <% end %>
        <% end %>
      </tbody>
    </table>


    <div class="container text-center">
  <div class="row">

    <%= simple_form_for @sale, :url => new_sale_path, :method => :get do |f| %>
    <div class="input-group date">
      <%= f.input :date, :input_html => { value: params[:date], class: "form-control", id: :Datetimepicker }  %>
      <%= f.hidden_field :friend_id, value: @friend.id%>
      <%= f.submit "Submit", class: "btn btn-primary" %>
    </div>
    <% end %>

    <%= content_for(:after_js) do %>
    <script type="text/javascript">
      $(function () {
        $('#Datetimepicker').datetimepicker({ dateFormat: 'yyyy-mm-dd' });
      });
    </script>
    <% end %>

  </div>
</div>

  <div class="flex">
    <div style="margin-right: 10px"  class=" text-center description">
      <%= link_to "Back to list", root_path, class: "btn btn-primary" %>
    </div>

  </div>

<div id="map" style="width: 100%; height: 600px;"></div>

<% content_for(:after_js) do %>
  <%= javascript_tag do %>
    $(document).ready(function() {
      var handler = Gmaps.build('Google');
      handler.buildMap({ internal: { id: 'map' } }, function() {
        markers = handler.addMarkers(<%= raw @hash.to_json %>);
        handler.bounds.extendWith(markers);
        handler.fitMapToBounds();
        if (markers.length == 0) {
          handler.getMap().setZoom(2);
        } else if (markers.length == 1) {
          handler.getMap().setZoom(14);
        }
      });
    });
  <% end %>
<% end %>
